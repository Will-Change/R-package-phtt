<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="The package provides estimation procedures for panel data with large dimensions n, T, and general forms of unobservable heterogeneous effects. Particularly, the estimation procedures are those of Bai (2009) and Kneip, Sickles, and Song (2012), which complement one another very well: both models assume the unobservable heterogeneous effects to have a factor structure. The method of Bai (2009) assumes that the factors are stationary, whereas the method of Kneip et al. (2012) allows the factors to be non-stationary. Additionally, the phtt package provides a wide range of dimensionality criteria in order to estimate the number of the unobserved factors simultaneously with the remaining model parameters.">
<title>Panel Data Analysis with Heterogeneous Time Trends • phtt</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Panel Data Analysis with Heterogeneous Time Trends">
<meta property="og:description" content="The package provides estimation procedures for panel data with large dimensions n, T, and general forms of unobservable heterogeneous effects. Particularly, the estimation procedures are those of Bai (2009) and Kneip, Sickles, and Song (2012), which complement one another very well: both models assume the unobservable heterogeneous effects to have a factor structure. The method of Bai (2009) assumes that the factors are stationary, whereas the method of Kneip et al. (2012) allows the factors to be non-stationary. Additionally, the phtt package provides a wide range of dimensionality criteria in order to estimate the number of the unobserved factors simultaneously with the remaining model parameters.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">phtt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="r-package-phtt">R package <code>phtt</code>
<a class="anchor" aria-label="anchor" href="#r-package-phtt"></a>
</h1></div>
<p>This repository contains the R package <code>phtt</code> for estimating panel data models that generalize the classical fixed effects models by allow to control for <em>time varying</em> individual fixed effects. A readable introduction to the panel data models, the estimation and the inference procedures of this package are described in</p>
<p>Bada, O., &amp; Liebl, D. (2014). <a href="https://www.jstatsoft.org/index.php/jss/article/view/v059i06/768" class="external-link">phtt: Panel Data Analysis with Heterogeneous Time Trends in R</a>. Journal of Statistical Software, 59(6), 1–33. <a href="https://doi.org/10.18637/jss.v059.i06" class="external-link uri">https://doi.org/10.18637/jss.v059.i06</a></p>
<p>Free Download the paper (PDF): <a href="https://www.jstatsoft.org/index.php/jss/article/view/v059i06/768" class="external-link">HERE</a></p>
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>The R package <code>phtt</code> contains three main functions.</p>
<ol style="list-style-type: decimal">
<li>The <code><a href="reference/Eup.html">Eup()</a></code> function implements the estimation and inference methods of<ul>
<li>Bai, J. (2009). Panel data models with interactive fixed effects. Econometrica, 77(4), 1229-1279. and the refined estimation version described in</li>
<li>Bada, O., &amp; Kneip, A. (2014). Parameter cascading for panel models with unknown number of unobserved factors: An application to the credit spread puzzle. Computational Statistics &amp; Data Analysis, 76, 95-115.</li>
</ul>
</li>
<li>The <code><a href="reference/KSS.html">KSS()</a></code> function implements the estimation and inference methods of<ul><li>Kneip, A., Sickles, R. C., &amp; Song, W. (2012). A new panel data treatment for heterogeneity in time trends. Econometric theory, 28(3), 590-628.</li></ul>
</li>
<li>The <code><a href="reference/OptDim.html">OptDim()</a></code> function contains the implementations of many different procedure for estimating the dimension of the unobserved factor structure.</li>
</ol>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<pre class="{r}"><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"lidom/R-package-phtt"</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"phtt"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"phtt"</span><span class="op">)</span></span></code></pre>
<div class="section level3">
<h3 id="r-codes">R Codes<a class="anchor" aria-label="anchor" href="#r-codes"></a>
</h3>
<p>The following R codes reproduce the figures of our article:</p>
<p>Bada, O., &amp; Liebl, D. (2014). <a href="https://www.jstatsoft.org/index.php/jss/article/view/v059i06/768" class="external-link">phtt: Panel Data Analysis with Heterogeneous Time Trends in R</a>. Journal of Statistical Software, 59(6), 1–33. <a href="https://doi.org/10.18637/jss.v059.i06" class="external-link uri">https://doi.org/10.18637/jss.v059.i06</a></p>
<pre class="{r}"><code><span><span class="co">## Load package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"phtt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Load Data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Cigar"</span>, package <span class="op">=</span> <span class="st">"phtt"</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">46</span></span>
<span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="co">## Dependent variable: Cigarette-Sales per Capita</span></span>
<span><span class="va">l.Consumption</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">Cigar</span><span class="op">$</span><span class="va">sales</span>, <span class="cn">T</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Independent variables: Consumer Price Index</span></span>
<span><span class="va">cpi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">Cigar</span><span class="op">$</span><span class="va">cpi</span>, <span class="cn">T</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="co">## Real Price per Pack of Cigarettes</span></span>
<span><span class="va">l.Price</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">Cigar</span><span class="op">$</span><span class="va">price</span>, <span class="cn">T</span>, <span class="va">n</span><span class="op">)</span><span class="op">/</span><span class="va">cpi</span><span class="op">)</span></span>
<span><span class="co">## Real Disposable Income per Capita</span></span>
<span><span class="va">l.Income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">Cigar</span><span class="op">$</span><span class="va">ndi</span>, <span class="cn">T</span>, <span class="va">n</span><span class="op">)</span><span class="op">/</span><span class="va">cpi</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="co">## Figure 1:</span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="va">scl</span> <span class="op">&lt;-</span> <span class="fl">1.6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">l.Consumption</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Log's of\nCigar-Consumption"</span>, ylab <span class="op">=</span> <span class="st">""</span>, </span>
<span>  xlab <span class="op">=</span> <span class="st">"Time"</span>, cex.main <span class="op">=</span> <span class="va">scl</span>, cex.lab <span class="op">=</span> <span class="va">scl</span>, cex.axis <span class="op">=</span> <span class="va">scl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">l.Price</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Log's of\nreal Prices"</span>, ylab <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>, </span>
<span>  cex.main <span class="op">=</span> <span class="va">scl</span>, cex.lab <span class="op">=</span> <span class="va">scl</span>, cex.axis <span class="op">=</span> <span class="va">scl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">l.Income</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Log's of\nreal Income"</span>, ylab <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>, </span>
<span>  cex.main <span class="op">=</span> <span class="va">scl</span>, cex.lab <span class="op">=</span> <span class="va">scl</span>, cex.axis <span class="op">=</span> <span class="va">scl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="co">## Estimation of the KSS model</span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="va">Cigar.KSS</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/KSS.html">KSS</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">l.Consumption</span> <span class="op">~</span> <span class="va">l.Price</span> <span class="op">+</span> <span class="va">l.Income</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">Cigar.KSS.summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Cigar.KSS</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="co">## Figure 2:</span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Cigar.KSS.summary</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Estimation of the number of factors</span></span>
<span><span class="fu"><a href="reference/OptDim.html">OptDim</a></span><span class="op">(</span>Obj <span class="op">=</span> <span class="va">l.Consumption</span>, criteria <span class="op">=</span> <span class="st">"PC1"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">OptDim.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/OptDim.html">OptDim</a></span><span class="op">(</span>Obj <span class="op">=</span> <span class="va">l.Consumption</span>, criteria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PC3"</span>, <span class="st">"ER"</span>, <span class="st">"GR"</span>, <span class="st">"IPC1"</span>, </span>
<span>  <span class="st">"IPC2"</span>, <span class="st">"IPC3"</span><span class="op">)</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="co">## Figure 3:</span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">OptDim.obj</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## This is for interactive use.</span></span>
<span><span class="co">## KSS(formula = l.Consumption ~ -1 + l.Price + l.Income, consult.dim = TRUE)</span></span>
<span></span>
<span><span class="co">## First differences of the data:</span></span>
<span><span class="va">d.l.Consumption</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">l.Consumption</span><span class="op">)</span></span>
<span><span class="va">d.l.Price</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">l.Price</span><span class="op">)</span></span>
<span><span class="va">d.l.Income</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">l.Income</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="co">## Estimation of the EUP model</span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="op">(</span><span class="va">Cigar.Eup</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Eup.html">Eup</a></span><span class="op">(</span><span class="va">d.l.Consumption</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">d.l.Price</span> <span class="op">+</span> <span class="va">d.l.Income</span>, dim.criterion <span class="op">=</span> <span class="st">"PC3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Cigar.Eup</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="co">## Figure 4:</span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Cigar.Eup</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="co">## Estimation of the KSS model with additive individual effects</span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="va">Cigar2.KSS</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/KSS.html">KSS</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">l.Consumption</span> <span class="op">~</span> <span class="va">l.Price</span> <span class="op">+</span> <span class="va">l.Income</span>, additive.effects <span class="op">=</span> <span class="st">"individual"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">Cigar2.KSS.summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Cigar2.KSS</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="co">## Figure 5:</span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="va">scl</span> <span class="op">&lt;-</span> <span class="fl">1.75</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Cigar2.KSS.summary</span>, cex.main <span class="op">=</span> <span class="fl">1.25</span>, cex.lab <span class="op">=</span> <span class="va">scl</span>, cex.axis <span class="op">=</span> <span class="va">scl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="co">## Testing for model specification</span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="va">twoways.obj</span>     <span class="op">&lt;-</span> <span class="fu"><a href="reference/Eup.html">Eup</a></span><span class="op">(</span><span class="va">d.l.Consumption</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">d.l.Price</span> <span class="op">+</span> <span class="va">d.l.Income</span>, factor.dim <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  additive.effects <span class="op">=</span> <span class="st">"twoways"</span><span class="op">)</span></span>
<span><span class="va">not.twoways.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Eup.html">Eup</a></span><span class="op">(</span><span class="va">d.l.Consumption</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">d.l.Price</span> <span class="op">+</span> <span class="va">d.l.Income</span>, factor.dim <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  additive.effects <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="reference/checkSpecif.html">checkSpecif</a></span><span class="op">(</span>obj1 <span class="op">=</span> <span class="va">twoways.obj</span>, obj2 <span class="op">=</span> <span class="va">not.twoways.obj</span>, level <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">Eup.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Eup.html">Eup</a></span><span class="op">(</span><span class="va">d.l.Consumption</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">d.l.Price</span> <span class="op">+</span> <span class="va">d.l.Income</span>, additive.effects <span class="op">=</span> <span class="st">"twoways"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkSpecif.html">checkSpecif</a></span><span class="op">(</span><span class="va">Eup.obj</span>, level <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="va">KSS.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/KSS.html">KSS</a></span><span class="op">(</span><span class="va">l.Consumption</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">l.Price</span> <span class="op">+</span> <span class="va">l.Income</span>, additive.effects <span class="op">=</span> <span class="st">"twoways"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkSpecif.html">checkSpecif</a></span><span class="op">(</span><span class="va">KSS.obj</span>, level <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Percentages of explained variances</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Cigar2.KSS</span><span class="op">)</span><span class="op">$</span><span class="va">Var.shares.of.loadings.param</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Cigar2.KSS</span><span class="op">)</span><span class="op">$</span><span class="va">Var.shares.of.loadings.param</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Cigar2.KSS</span><span class="op">)</span><span class="op">$</span><span class="va">Var.shares.of.loadings.param</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Cigar2.KSS</span><span class="op">)</span><span class="op">$</span><span class="va">Var.shares.of.loadings.param</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Cigar2.KSS</span><span class="op">)</span><span class="op">$</span><span class="va">Var.shares.of.loadings.param</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="co">## Figure 6:</span></span>
<span><span class="co">## ##############################################################</span></span>
<span><span class="va">scl</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Cigar2.KSS</span><span class="op">)</span><span class="op">$</span><span class="va">Common.factors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Cigar2.KSS</span><span class="op">)</span><span class="op">$</span><span class="va">Ind.loadings.param</span><span class="op">[</span>, </span>
<span>  <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Variance of time-varying indiv. effects\n in direction of the 1. common factor"</span>, </span>
<span>  xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">""</span>, cex.main <span class="op">=</span> <span class="va">scl</span>, cex.lab <span class="op">=</span> <span class="va">scl</span>, cex.axis <span class="op">=</span> <span class="va">scl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Cigar2.KSS</span><span class="op">)</span><span class="op">$</span><span class="va">Common.factors</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Cigar2.KSS</span><span class="op">)</span><span class="op">$</span><span class="va">Ind.loadings.param</span><span class="op">[</span>, </span>
<span>  <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Variance of time-varying indiv. effects\n in direction of the 2. common factor"</span>, </span>
<span>  xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">""</span>, cex.main <span class="op">=</span> <span class="va">scl</span>, cex.lab <span class="op">=</span> <span class="va">scl</span>, cex.axis <span class="op">=</span> <span class="va">scl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=phtt" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2" class="external-link">GPL-2</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing phtt</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Dominik Liebl <br><small class="roles"> Author, maintainer </small>  </li>
<li>Oualid Bada <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dominik Liebl, Oualid Bada.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
